# プロンプトエンジニアリング基本テクニック

## 概要

このドキュメントでは、Claudeを効果的に活用するための3つの基本テクニックを学びます。これらは最も広く使える実践的な技術であり、プロンプトエンジニアリングの基礎となるものです。

**学べる3つの基本テクニック:**
1. **明確で直接的な指示** - あいまいさを排除し、具体的に伝える
2. **XMLタグの活用** - プロンプトを構造化し、正確性を向上
3. **例示による学習（Multishot Prompting）** - 具体例で期待する動作を示す

## 目次

- 明確で直接的な指示（Be Clear and Direct）
  - Claudeとのコミュニケーションの基本
  - 明確なプロンプトの黄金律
  - コンテキスト情報の提供方法
- XMLタグの活用（Use XML Tags）
  - XMLタグを使う理由
  - タグ付けのベストプラクティス
  - 他の技術との組み合わせ
- 例示による学習（Multishot Prompting）
  - 例を使う理由とメリット
  - 効果的な例の作り方
  - 最適な例の数と多様性

---

## 明確で直接的な指示（Be Clear and Direct）

### Claudeとのコミュニケーションの基本

Claudeを**「優秀だが非常に新しい従業員（しかも記憶喪失）」**だと考えてください。

#### Claudeの特徴

- **高い能力**: 複雑なタスクを処理できる
- **コンテキスト不足**: あなたの規範、スタイル、ガイドライン、好みのワークフローを知らない
- **明示的な指示が必要**: 暗黙の了解は通用しない

### 明確なプロンプトの黄金律

**テスト方法:**
あなたのプロンプトを、最小限のコンテキストしか持たない同僚に見せてください。

- **同僚が混乱する場合** → Claudeも混乱する可能性が高い
- **同僚が理解できる場合** → Claudeも正確に実行できる可能性が高い

### コンテキスト情報の提供方法

#### 1. タスク結果の使用目的を伝える

**悪い例:**
```
この文章を要約してください。
```

**良い例:**
```
この文章を要約してください。この要約は、経営陣への週次報告書に使用されます。
```

#### 2. ターゲットオーディエンスを明示する

**悪い例:**
```
プログラミングについて説明してください。
```

**良い例:**
```
10歳の子供にもわかるように、プログラミングについて説明してください。
```

#### 3. ワークフロー内での位置を説明する

**悪い例:**
```
データを分析してください。
```

**良い例:**
```
このデータは顧客調査の第一段階で収集されました。次のステップでマーケティング戦略を立案するため、主要なトレンドと顧客の懸念事項を特定してください。
```

#### 4. 最終目標・成功基準を明確にする

**悪い例:**
```
レポートを書いてください。
```

**良い例:**
```
レポートを書いてください。目標は、投資家に製品の市場機会を納得させることです。データに基づいた具体的な数値と、競合分析を含めてください。
```

### 望む行動を具体的に指示する

#### コード出力のみが欲しい場合

**明示的に伝える:**
```
以下の機能を実装してください。説明やコメントは不要で、動作するコードのみを出力してください。
```

#### 段階的な指示を提供する

**番号付きリストや箇条書きを使用:**

```
以下の手順で顧客メールに返信してください：

1. 顧客の主な懸念事項を特定する
2. 懸念事項に対する解決策を提案する
3. 次のステップを明確に示す
4. 丁寧でプロフェッショナルなトーンで書く
```

### ポイント・注意事項

- **明確さと具体性が最優先**: あいまいな指示は、あいまいな結果を生む
- **コンテキストは力**: より多くの背景情報を提供することで、パフォーマンスが大幅に向上
- **構造化された指示**: 番号付きリスト・箇条書きを使うことで、正確な実行が保証される

---

## XMLタグの活用（Use XML Tags）

### XMLタグを使う理由

プロンプトに**複数のコンポーネント**（コンテキスト、指示、例など）がある場合、XMLタグを使用することで解析精度と出力品質が向上します。

**基本的な使用例:**
```xml
<instructions>
この契約書を分析し、主要なリスク条項を特定してください。
</instructions>

<contract>
[契約書の内容]
</contract>

<formatting>
各リスク条項について、以下の形式で出力してください：
- リスクの種類
- 該当する条項番号
- 潜在的な影響
</formatting>
```

### XMLタグの4つのメリット

#### 1. **明確性（Clarity）**
- プロンプトの異なる部分を明確に分離
- 良好な構造を保証

#### 2. **正確性（Accuracy）**
- 誤解釈のエラーを削減
- Claudeが各部分の役割を正確に理解

#### 3. **柔軟性（Flexibility）**
- プロンプト全体を書き直さずに、特定のコンポーネントを簡単に変更可能
- メンテナンスとイテレーションが容易

#### 4. **解析可能性（Parseability）**
- 後処理で特定の応答部分を抽出しやすい
- プログラムでの処理が簡単

### 重要な注意事項

- **特定の「ベスト」XMLタグは存在しない**: Claudeは特定のXMLタグで特別に訓練されているわけではない
- **推奨事項**: タグ名は内容と意味的に合致するものを使用する

**良いタグ名の例:**
- `<instructions>`, `<example>`, `<contract>`, `<code>`, `<output_format>`

**避けるべきタグ名:**
- `<tag1>`, `<part_a>`, `<xyz>` （意味が不明確）

### タグ付けのベストプラクティス

#### 1. 一貫性を保つ

**同じタグ名をプロンプト全体で使用:**
```xml
<example>
入力: 東京の天気を教えて
出力: 東京の現在の天気は晴れです。気温は25度です。
</example>

<example>
入力: 大阪の気温は？
出力: 大阪の現在の気温は23度です。
</example>
```

**タグ名を参照する:**
```
<contract>タグ内の契約書を使用して、リスク条項を分析してください。
```

#### 2. タグをネストする

階層構造を使用して、複雑な関係を表現:

```xml
<examples>
  <example>
    <input>質問1</input>
    <output>回答1</output>
  </example>
  <example>
    <input>質問2</input>
    <output>回答2</output>
  </example>
</examples>
```

### パワーユーザー向けのヒント

XMLタグを他の技術と組み合わせることで、**超構造化された高パフォーマンスなプロンプト**を作成できます:

**Multishot Prompting + XMLタグ:**
```xml
<examples>
  <example>...</example>
  <example>...</example>
</examples>
```

**Chain of Thought + XMLタグ:**
```xml
<thinking>
ステップ1: まず...
ステップ2: 次に...
</thinking>

<answer>
最終的な回答
</answer>
```

### ポイント・注意事項

- **構造化がカギ**: XMLタグはプロンプトの構造を明確にする最良の方法
- **保守性向上**: プロンプトの一部を変更する際、他の部分に影響を与えにくい
- **プログラマブル**: 出力を解析・処理するシステムに最適

---

## 例示による学習（Multishot Prompting）

### 例を使う理由

Multishot Prompting（マルチショット プロンプティング）は、**「Few-shot Prompting」**とも呼ばれ、Claudeの動作を導くために具体的な例を提供する手法です。

**なぜ効果的か:**
- 指示だけで説明するより、**具体例を示す方が遥かに明確**
- 特に構造化された出力や特定のフォーマット要件がある場合に有効

### パワーヒント

**推奨される例の数: 3～5個**

- より多くの例 = より良いパフォーマンス
- 特に複雑なタスクでは、多様な例が重要

### 例を使う3つのメリット

#### 1. **精度向上（Accuracy）**
指示の誤解釈を減らす

**例がない場合:**
```
顧客の感情を分析してください。
```
→ 出力形式や詳細レベルがあいまい

**例がある場合:**
```
顧客の感情を分析してください。

<example>
入力: 「商品が壊れていました。最悪です。」
出力: 
- 感情: ネガティブ
- スコア: 1/5
- 理由: 商品の品質問題、強い不満
</example>
```
→ 出力形式と分析の詳細度が明確

#### 2. **一貫性の保証（Consistency）**
統一された構造とスタイルを強制

**複数の例で形式を統一:**
```xml
<examples>
  <example>
    入力: [テキスト1]
    カテゴリ: 技術サポート
    優先度: 高
  </example>
  <example>
    入力: [テキスト2]
    カテゴリ: 請求問い合わせ
    優先度: 中
  </example>
</examples>
```

#### 3. **パフォーマンス向上（Performance）**
複雑なタスクを処理する能力を向上

### 効果的な例の作り方

効果的な例は以下の3つの特性を持つ必要があります:

#### 1. **関連性（Relevant）**

実際のユースケースを反映する例を使用

**悪い例（関連性が低い）:**
```
タスク: 医療記録を要約する
例: レストランのレビューを要約
```

**良い例（関連性が高い）:**
```
タスク: 医療記録を要約する
例: 実際の医療記録の要約
```

#### 2. **多様性（Diverse）**

エッジケースや潜在的な課題をカバーする

**単調な例（避けるべき）:**
```xml
<examples>
  <example>入力: 短い文章 → 出力: 要約</example>
  <example>入力: 短い文章 → 出力: 要約</example>
  <example>入力: 短い文章 → 出力: 要約</example>
</examples>
```

**多様な例（推奨）:**
```xml
<examples>
  <example>入力: 短い文章 → 出力: 簡潔な要約</example>
  <example>入力: 長い複雑な文章 → 出力: 詳細な要約</example>
  <example>入力: 専門用語が多い文章 → 出力: 専門用語を解説した要約</example>
</examples>
```

**重要:** 十分に多様でないと、意図しないパターン認識が発生する可能性がある

#### 3. **明確性（Clear）**

`<example>`タグで各例をラップし、複数の例を`<examples>`タグでネストする

**明確な例の構造:**
```xml
<examples>
  <example>
    <input>東京から大阪までの移動方法を教えて</input>
    <output>
    東京から大阪までの主な移動方法:
    1. 新幹線（約2時間30分）
    2. 飛行機（約1時間15分、移動時間除く）
    3. 高速バス（約8時間）
    
    おすすめは新幹線です。速くて快適です。
    </output>
  </example>
  
  <example>
    <input>富士山の高さは？</input>
    <output>
    富士山の標高は3,776メートルです。日本最高峰の山です。
    </output>
  </example>
</examples>
```

### プロのヒント

**Claudeに例を評価・生成させる:**

```
以下の例が、関連性、多様性、明確性の観点で十分かどうか評価してください。

<examples>
[あなたの例]
</examples>

改善提案や、追加すべき例があれば教えてください。
```

**初期セットから追加例を生成:**
```
以下の例に基づいて、さらに3つの多様な例を生成してください。

<examples>
[あなたの初期例]
</examples>
```

### ポイント・注意事項

- **例は「秘密兵器のショートカット」**: 複雑な指示を書くより、良い例を示す方が効果的
- **3～5個が最適**: パフォーマンスと効率のバランス
- **品質が重要**: 関連性、多様性、明確性の3つを満たす例を作る
- **Claudeを活用**: 例の品質向上にClaudeの力を借りることができる

---

## 3つの基本テクニックの組み合わせ

### 最強のプロンプトを作る

3つの基本テクニックを組み合わせることで、非常に効果的なプロンプトを作成できます:

**統合例:**
```xml
<instructions>
顧客のフィードバックを分析し、感情とカテゴリを特定してください。
このデータはカスタマーサポートチームの優先順位付けに使用されます。

以下の手順で処理してください：
1. フィードバックの感情（ポジティブ、ネガティブ、中立）を判定
2. 問い合わせのカテゴリを特定
3. 緊急度を評価（高、中、低）
</instructions>

<examples>
  <example>
    <feedback>商品が壊れていました。すぐに返金してください。</feedback>
    <output>
    - 感情: ネガティブ
    - カテゴリ: 商品の品質問題
    - 緊急度: 高
    - 理由: 強い不満と即時対応の要求
    </output>
  </example>
  
  <example>
    <feedback>商品は良いのですが、配送に時間がかかりました。</feedback>
    <output>
    - 感情: 中立（やや不満）
    - カテゴリ: 配送に関する問題
    - 緊急度: 低
    - 理由: 製品には満足しているが、配送プロセスの改善余地あり
    </output>
  </example>
</examples>

<customer_feedback>
[分析対象のフィードバック]
</customer_feedback>

<output_format>
以下の形式で出力してください：
- 感情: [ポジティブ/ネガティブ/中立]
- カテゴリ: [カテゴリ名]
- 緊急度: [高/中/低]
- 理由: [判定理由]
</output_format>
```

このプロンプトは：
- ✅ **明確で直接的**: コンテキスト、使用目的、段階的な指示を提供
- ✅ **XMLタグで構造化**: 各コンポーネントが明確に区別されている
- ✅ **多様な例を提供**: 異なるシナリオでClaudeの動作を誘導

---

## まとめ

### 3つの基本テクニック

1. **明確で直接的な指示**
   - Claudeは「優秀だが新人の従業員」
   - コンテキスト、目的、段階的な指示を明示
   - 黄金律: 同僚が理解できるプロンプトを書く

2. **XMLタグの活用**
   - 明確性、正確性、柔軟性、解析可能性の4つのメリット
   - 一貫性とネスト構造を意識
   - 他の技術と組み合わせて最強のプロンプトを作る

3. **例示による学習（Multishot Prompting）**
   - 3～5個の多様な例を提供
   - 関連性、多様性、明確性を満たす例を作る
   - Claudeに例の評価と生成を依頼できる

### 実践のポイント

- **段階的な適用**: まず明確な指示から始め、必要に応じてXMLタグや例を追加
- **組み合わせが力**: 3つの技術を組み合わせることで、最高のパフォーマンスを実現
- **反復改善**: 実際に試し、結果を評価し、プロンプトを改善する

### 次のステップ

より高度な技術（Chain of Thought、System Prompts、Prefill、Chain Prompts）について学ぶために、次のドキュメント「03_思考と構造化テクニック.md」に進んでください。

---

## 参考リンク

- **Be Clear and Direct**: https://platform.claude.com/docs/en/build-with-claude/prompt-engineering/be-clear-and-direct
- **Use XML Tags**: https://platform.claude.com/docs/en/build-with-claude/prompt-engineering/use-xml-tags
- **Multishot Prompting**: https://platform.claude.com/docs/en/build-with-claude/prompt-engineering/multishot-prompting
- **GitHubチュートリアル**: https://github.com/anthropics/prompt-eng-interactive-tutorial
- **Google Sheetsチュートリアル**: https://docs.google.com/spreadsheets/d/19jzLgRruG9kjUQNKtCg1ZjdD6l6weA6qRXG5zLIAhC8
